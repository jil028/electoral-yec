---
title: "Visualization: Figures"
output: html_document
---
Purpose: to clean data and create figures in the background and results sections of the thesis.

# load packages

```{r}
library(readxl)
library(tidyverse)
library(ggrepel)
library(plotly)
library(forestplot)
library(vistime)
library(broom)
library(Amelia)
library(modelsummary)
library(kableExtra)
library(glue)
library(wesanderson)
library(cowplot)
library(patchwork)
library(showtext)

# set source directory
source_dir <- "/Users/jiayili/Desktop/honors-thesis-main/01-outputs/raw-data"
```


# figure: trend of turnout rates of elections in Hong Kong, 2011-2019----------
```{r}
############
# Figure 1 #
############

# create a tibble for overall turnouts (sources: HK SAR government's websites)
hk_elections_turnouts <-
  tribble(
    ~year, ~type, ~turnout,
    "2011", "District Council Election", 41.49,
    "2012", "Legislative Council Election", 53.05, 
    "2015", "District Council Election", 47.01,
    "2016", "Legislative Council Election", 58.28,
    "2019", "District Council Election", 71.23,
    "2021", "Legislative Council Election", 30.20
  )

# make the plot
plt_trend_turnouts <- 
  hk_elections_turnouts %>%
  ggplot(aes(x = year, y = turnout, label = turnout)) + 
  geom_point(stat = "identity", color = "darkgreen", 
             fill = "darkgreen", size = 12.5)  +
  geom_segment(aes(y = 0, 
                   x = year, 
                   yend = turnout, 
                   xend = year), 
               color = "darkgreen") +
  geom_text(color = "white", size = 4) +
  labs(y = "Cumulative turnourt rate (%)",
       x = "") +
  theme_bw() +
  ylim(0, 80) +
  facet_wrap(~type, nrow = 2, scales = "free_y",
             labeller = as_labeller(c("District Council Election" = "District Council Elections",
                                      "Legislative Council Election" = "Legislative Council Elections")))+
  coord_flip() +
  theme(axis.text = element_text(size = 14),
        strip.text = element_text(size = 14),
        axis.title.x = element_text(size = 14))


pdf('trend_turnouts.pdf', width = 8, height = 3.8)
plt_trend_turnouts
dev.off()
```


# figure: heatmaps--------------------------------------------------------------

```{r}
############
# Figure 2 #
############

# geographical data for important locations
important_places <-
  tribble(
    ~name, ~lat, ~lon,
    "Central", 22.280450253004485, 114.15844461419331,
    "Tsim Sha Tsui", 22.29886929148288, 114.17218451090143
  ) %>%
  st_as_sf(coords = c("lon", "lat"), 
           crs = 4326) 

# load raw hk map
hk_shp <- 
  read_sf(glue("{source_dir}/Hong_Kong_18_Districts (1)/HKDistrict18.shp")) %>%
  # standardize administrative district names
  mutate(
    ENAME = paste(ENAME, "DISTRICT"),
    ENAME = 
      case_when(
        row_number() == 6 ~ "CENTRAL AND WESTERN DISTRICT",
        row_number() == 17 ~ "DAI PO DISTRICT",
        TRUE ~ as.character(ENAME)
      )
  )

# load final openrice data sets
df_openrice <- 
  read_csv("~/Desktop/honors-thesis-main/00-data/cleaned-data/restaurant-data/final_openrice.csv")

df_openrice <-
  df_openrice %>%
  # standardize district names and the variable name
  mutate(
    ENAME = str_to_upper(dce_constituency)
  ) 

# find the number of total restaurants in a district (18 large administrative district)
op_total_df <- 
  df_openrice %>%
  group_by(ENAME) %>%
  summarise(total_restaurants = n()) %>%
  ungroup() #%>%
  # drop geometries
  #st_drop_geometry()

# count numbers of restaurants in a district by political ideology
op_count_df <- 
  df_openrice %>%
  group_by(ENAME, ideo_text) %>%
  summarise(n_restaurants = n()) %>%
  ungroup() #%>%
  # drop geometries
  #st_drop_geometry()

# keep only yellow restaurants
df_openrice <-
  left_join(op_count_df, op_total_df, by = "ENAME") %>%
  mutate(
    prop = n_restaurants / total_restaurants
  ) %>%
  filter(ideo_text == "Yellow")

# data frame for plotting
out <-
  hk_shp %>%
  left_join(df_openrice, by = "ENAME")

heatmap_yellow <-
  ggplot(out) +
  geom_sf(aes(fill = prop)) +
  scale_fill_gradient(low = "white", high = "gold") +
  geom_sf(data = important_places, shape = 8, color = "black", size = 3) +
  geom_label_repel(
    data = important_places,
    aes(label = name, geometry = geometry),
    stat = "sf_coordinates",
    min.segment.length = 0,
    colour = "black",
    fill = NA,
    segment.colour = "black",
    segment.size = 0.2,
    label.size = NA,
    nudge_x = 10,
    nudge_y = -0.05
  ) +
  theme_bw() +
  labs(
    fill = '', y = "", x = ""
  ) +
  theme(
    legend.text = element_text(size = 12),
    axis.text.y = element_text(size = 12),
    axis.text.x = element_text(size = 12)
  )


# keep only blue restaurants
df_openrice <-
  left_join(op_count_df, op_total_df, by = "ENAME") %>%
  mutate(
    prop = n_restaurants / total_restaurants
  ) %>%
  filter(ideo_text == "Blue")

# data frame for plotting
out <-
  hk_shp %>%
  left_join(df_openrice, by = "ENAME")

heatmap_blue <-
  ggplot(out) +
  geom_sf(aes(fill = prop)) +
  scale_fill_gradient(low = "white", high = "cornflowerblue") +
  geom_sf(data = important_places, shape = 8, color = "black", size = 3) +
  geom_label_repel(
    data = important_places,
    aes(label = name, geometry = geometry),
    stat = "sf_coordinates",
    min.segment.length = 0,
    colour = "black",
    fill = NA,
    segment.colour = "black",
    segment.size = 0.2,
    label.size = NA,
    nudge_x = 10,
    nudge_y = -0.05
  ) +
  theme_bw() +
  labs(
    fill = '', y = "", x = ""
  ) +
  theme(
    legend.text = element_text(size = 12),
    axis.text.y = element_text(size = 12),
    axis.text.x = element_text(size = 12)
  )


# put the two heatmaps together
heatmap <-
  heatmap_yellow / heatmap_blue

pdf('heatmap.pdf', width = 9, height = 12)
heatmap
dev.off()
```


# figure: electoral democracy index---------------------------------------------
# source: v-dem (https://v-dem.net/data/the-v-dem-dataset/country-year-v-dem-core/)

```{r}
############
# Figure 3 #
############

# load v-dem data
vdem_raw <-
  read.csv(glue("{source_dir}/Country_Year_V-Dem_Core_CSV_v12/V-Dem-CY-Core-v12.csv"))

vdem_hk_raw <-
  vdem_raw %>%
  # subset to include hk only
  filter(country_name == "Hong Kong") %>%
  # subset to those only after 1980
  filter(year >= 1980)

# set the label function for significant digits
scaleFUN <- function(x) sprintf("%.1f", x)

# plot
plt_elect_dem_index <- 
  vdem_hk_raw %>%
  ggplot(aes(x = year, y = v2x_polyarchy)) +
  geom_line() +
  geom_point() +
  scale_y_continuous(labels = scaleFUN, limits = c(0, 1)) +
  # annotate important events
  geom_vline(xintercept = 1997, linetype = 2, color = "coral3") +
  annotate("text", x = 1989, y = 0.8, 
           label = "1997: Handover of Hong Kong",
           colour = "coral3", size = 5) +
  geom_vline(xintercept = 2014, linetype = 2, color = "coral3") +
  annotate("text", x = 2007, y = 0.15, 
           label = "2014: Umbrella Movement",
           colour = "coral3", size = 5) +
  # adjust themes
  theme_bw() +
  theme(axis.text.x = element_text(size = 14),
        axis.text.y = element_text(size = 14),
        axis.title.y = element_text(size = 14),
        axis.title.x = element_blank()) +
  ylab("Electoral democracy index")
```


# figure: grouped bar chart of politicized restaurants by political ideology----

```{r}
##############
## Figure 4 ##
##############

# load raw data
openrice_raw <- 
    read.csv(glue("{source_dir}/openrice_final_raw.csv"))

# group data and get summary stats
out <-
  openrice_raw %>%
  group_by(dce_constituency, ideo_text) %>%
  summarise(
    count = n()
   )
   
# set the breaks and ticklabels
breaks <- c(seq(0, 500, by = 50))
ticklabels <- c('0','50','100','150', '200',"250", '300', "350", "400", "450", "500")

# make the bar chart
bar_by_ideo <-
    out %>%
    # sorted bars
    ggplot(aes(x = reorder(dce_constituency, count), y = count, fill = ideo_text, label = count)) +
    geom_col(width = 0.7, position = position_dodge(0.7), alpha = 0.7) +
    geom_text(position = position_dodge(width = 0.9),
              hjust = -0.5, size = 2.5) +
    scale_y_continuous(limits = c(0, 460), expand = c(0,0), 
                       breaks = breaks, labels = ticklabels, 
                       sec.axis = sec_axis(~ . * 1, breaks = breaks, labels = ticklabels)) + 
    coord_flip() +
    # recode the legend
    scale_fill_manual(name = "Political support",
                      labels = c("Blue (pro-Beijing)", "Yellow (pro-democracy)"),
                      values=c("cornflowerblue", "gold")) +
    # adjust themes
    theme_minimal() +
    theme(text = element_text(size = 12)) +
    theme(legend.direction = "horizontal", 
          legend.position = "bottom",
          legend.box = "horizontal",
          panel.grid.major = element_blank()) +
    guides(fill = guide_legend(override.aes = list(size = 4.5))) +
    ylab("Number of restaurants") +
    xlab(" ")
```


# figure: timeline of the development of the YEC -------------------------------

```{r}
##############
## Figure 5 ##
##############

# create a tibble for event data
df_timeline_2019 <-
  tribble(
    ~start_date, ~event, ~type, ~end_date,
    "2019-03-15", "Beginning of the Anti-ELAB Movement", "Mass protests", "2019-03-15",
    "2019-06-09", "Escalation of protests", "Mass protests", "2019-12-1", # set to end on 12/1 given that COVID-19 started
    "2019-07-01", "Termination of the Yoshinoya staff's employment", "Development of the YEC", "2019-07-01",
    "2019-10-10", '"Day of Thanks"', "Development of the YEC", "2019-10-10",
    "2019-10-26", '"Shopping Spree Day"', "Development of the YEC", "2019-10-26",
    "2019-11-24", "District Council Election", "Election", "2019-11-24"
  )

timeline_2019 <-
  gg_vistime(df_timeline_2019, col.event = "event", 
             col.group = "type", optimize_y = FALSE,
             col.start = "start_date", col.end = "end_date", 
             linewidth = 5.5, 
             show_labels = FALSE) +
  theme_bw() +
  theme(axis.text.y = element_text(size = 14),
        axis.text.x = element_text(size = 14)) 

# repel text labels
timeline_2019_final <-
  timeline_2019 + geom_text_repel(data = timeline_2019$layers[[3]]$data,
                                  label = timeline_2019$layers[[3]]$data$label, 
                                  size = 4, 
                                  color = "black")
```


# figure: locationns of protest sites ------------------------------------------
# source: HKU

```{r}
##############
## Figure 6 ##
##############

protests <-
  read_sf("/Users/jiayili/Desktop/honors-thesis-main/01-outputs/raw-data/event_v2/event.shp")

cleaned_protests <-
  protests %>%
  # keep only to 2019
  filter(event_id <= 2113)

protest_map <-
  ggplot() +
  geom_sf(data = hk_shp) +
  geom_sf(data = out, aes(fill = prop)) +
  scale_fill_gradient(low = "white", high = "gold") +
  geom_sf(data = cleaned_protests, shape = 9, color = "orangered3", 
          size = 2, alpha = 0.5) +
  theme_bw() +
  labs(
    fill = ''
  ) +
  theme(legend.text = element_text(size=8))

# save  
pdf('protest-sites.pdf', width = 9, height = 4.5)
protest_map
dev.off()
```


# ------------------------------------------------------------------------------
# visualize analysis outputs

```{r}
# load analysis data frame
# set the path
path <- "~/Desktop/honors-thesis-main/00-data/cleaned-data"

# load analysis data frame
df_analysis <-
  readRDS(glue("{path}/df-analysis.RDS"))
```


# plot: parallel trends assumptions -------------------------------------------

```{r}
##############
## Figure 7 ##
##############

# subset to only include data from 2019
df_2019 <-
  df_analysis %>%
  filter(year == 2019)

# get the median proportion of yellow restaurants in a joined district
median_prop_yellow <- median(df_2019$prop_Yellow, na.rm = T)

# create treatment and control groups
# ="Treatment"-->larger than the median above
group <-
  df_2019 %>%
  mutate(
    group =
      case_when(
        prop_Yellow >= median_prop_yellow ~ "Treatment",
        TRUE ~ "Control"
      )
  ) %>%
  select(fake_unit_id, group)

# join the main data frame
df_parallel <-
  df_analysis %>%
  left_join(group, by = "fake_unit_id") %>%
  group_by(year, group) %>%
  # get the mean votes for different ideological groups by year and by group
  summarise(
    mean_prop_votes_demo = mean(prop_votes_demo, na.rm = TRUE),
    mean_prop_votes_est = mean(prop_votes_est, na.rm = TRUE),
    mean_prop_turnours = mean(sum_joined_dist_total, na.rm = TRUE)
  )
```

```{r}
# set ticks and tick labels
ticks <- c(2011, 2015, 2019)
tick_labels <- c("2011", "2015", "2019")
  
plt_parallel_trends_votes_demo <-
  df_parallel %>%
  ggplot(aes(x = year, y = mean_prop_votes_demo, color = group)) +
  geom_point() +
  geom_line(linewidth = 1) +
  geom_vline(xintercept = 2017, linetype = 2, color = "black") +
  scale_x_continuous(breaks = ticks, labels = tick_labels) +
  ylim(c(0, 0.5)) +
  ylab("Vote shares: pro-democracy") +
  # recode the legend
  scale_color_manual(name = "Group",
                     labels = c("Control", "Treatment"),
                     values = wes_palette("Royal1")) +
  theme_bw() +
  theme(
    axis.title.x = element_blank(),
    axis.text.x = element_text(size = 18),
    axis.title.y = element_text(size = 18),
    axis.text.y = element_text(size = 18),
    legend.position = "none",
    legend.title = element_text(size = 16),
    legend.text = element_text(size = 16)
  )

plt_parallel_trends_votes_est <-
  df_parallel %>%
  ggplot(aes(x = year, y = mean_prop_votes_est, color = group)) +
  geom_point() +
  geom_line(linewidth = 1) +
  geom_vline(xintercept = 2017, linetype = 2, color = "black") +
  scale_x_continuous(breaks = ticks, labels = tick_labels) +
  ylim(c(0, 0.5)) +
  ylab("Vote shares: pro-Beijing") +
  # recode the legend
  scale_color_manual(name = "Group",
                     labels = c("Control", "Treatment"),
                     values = wes_palette("Royal1")) +
  theme_bw() +
  theme(
    axis.title.x = element_blank(),
    axis.text.x = element_text(size = 18),
    axis.title.y = element_text(size = 18),
    axis.text.y = element_text(size = 18),
    legend.position = "none",
    legend.title = element_text(size = 16),
    legend.text = element_text(size = 16)
  )


plt_parallel_trends_turnouts <-
  df_parallel %>%
  ggplot(aes(x = year, y = mean_prop_turnours, color = group)) +
  geom_point() +
  geom_line(linewidth = 1) +
  geom_vline(xintercept = 2017, linetype = 2, color = "black") +
  scale_x_continuous(breaks = ticks, labels = tick_labels) +
  ylab("Turnouts: total votes cast") +
  # recode the legend
  scale_color_manual(name = "Group",
                     labels = c("Control", "Treatment"),
                     values = wes_palette("Royal1")) +
  theme_bw() +
  theme(
    axis.title.x = element_blank(),
    axis.text.x = element_text(size = 18),
    axis.title.y = element_text(size = 18),
    axis.text.y = element_text(size = 18),
    legend.direction = "horizontal", 
    legend.position = "bottom",
    legend.box = "horizontal",
    legend.title = element_text(size = 18),
    legend.text = element_text(size = 18)
  )

# put them together
plt_parallel_trends <-
  plot_grid(
  plot_grid(plt_parallel_trends_votes_demo, plt_parallel_trends_votes_est, nrow = 1, ncol = 2, labels = c('A', 'B')),
  plot_grid(NULL, plt_parallel_trends_turnouts, NULL, nrow = 1, rel_widths = c(0.5, 2, 0.5), labels = c("C")),
  nrow = 2
)

pdf('parallel-trends-1.pdf', width = 14, height = 10)
plt_parallel_trends
dev.off()

```


# plot subgroup effects --------------------------------------------------------

# subgroup 1: restaurant density

```{r}
##############
## Figure 8 ##
##############

# load analysis data frame
df_hte1_analysis <-
  readRDS(glue("{path}/df_hte1_analysis.RDS")) %>%
  dplyr::select(-grouped_geometry)

df_hte1_analysis$group <- factor(df_hte1_analysis$group, level = c("Above Median", "Below Median"))
```

# run analysis
```{r}
# fit DiD models for the two groups

# above median
hte1_a <- 
  felm(prop_votes_demo ~ prop_Yellow|year + fake_unit_id|0|fake_unit_id, 
       data = df_hte1_analysis, subset = group == "Above Median")
# below median
hte1_b <- 
  felm(prop_votes_demo ~ prop_Yellow|year + fake_unit_id|0|fake_unit_id, 
       data = df_hte1_analysis, subset = group == "Below Median")

```

# subgroup 2: historically pro-democracy district

```{r}
# subset to only include 2011 and 2015 data
hist_pro_demo_indicator <-
  df_analysis %>%
  filter(year %in% c(2011, 2015)) %>%
  group_by(fake_unit_id) %>%
  summarise(hist_mean_prop_votes_demo = mean(prop_votes_demo)) 

df_hte2_analysis <-
  df_analysis %>%
  left_join(hist_pro_demo_indicator, by = "fake_unit_id") %>%
  mutate(
    group = 
      case_when(
        hist_mean_prop_votes_demo >= median(hist_mean_prop_votes_demo, na.rm = T) ~ "Above median", ... = hist_mean_prop_votes_demo < median(hist_mean_prop_votes_demo, na.rm = T) ~ "Below median", TRUE ~ NA_character_)
  )
```

# run analysis

```{r}
# fit DiD model for the two groups

# above median
hte2_a <- 
  felm(prop_votes_demo ~ prop_Yellow|year + fake_unit_id|0|fake_unit_id, 
       data = df_hte2_analysis, subset = group == "Above median")

# below median
hte2_b <- 
  felm(prop_votes_demo ~ prop_Yellow|year + fake_unit_id|0|fake_unit_id, 
       data = df_hte2_analysis, subset = group == "Below median")
```


# create the df for plotting
```{r}
out <- data.frame(
  # group titles
  subgroup = c("Restaurant density (per 10,000 people)", "Restaurant density (per 10,000 people)",
               "Historical pro-democracy vote share", "Historical pro-democracy vote share"),
  # subgroup names
  group = c("Above median", "Below median", "Above median", "Below median"),
  # estimates
  coef = c(coef(hte1_a)["prop_Yellow"], coef(hte1_b)["prop_Yellow"],
           coef(hte2_a)["prop_Yellow"], coef(hte2_b)["prop_Yellow"]),
  # standard errors
  se = c(sqrt(diag(vcov(hte1_a))["prop_Yellow"]), sqrt(diag(vcov(hte1_b))["prop_Yellow"]),
         sqrt(diag(vcov(hte2_a))["prop_Yellow"]), sqrt(diag(vcov(hte2_b))["prop_Yellow"])),
  # p-value
  pvalue = c(summary(hte1_a)$coefficients["prop_Yellow", "Pr(>|t|)"],
             summary(hte1_b)$coefficients["prop_Yellow", "Pr(>|t|)"],
             summary(hte2_a)$coefficients["prop_Yellow", "Pr(>|t|)"],
             summary(hte2_b)$coefficients["prop_Yellow", "Pr(>|t|)"]),
  # sample size
  N = c(hte1_a$N, hte1_b$N,
        hte2_a$N, hte2_b$N),
  
  # 95% CI
  lower = c(tidy(hte1_a, conf.int = TRUE)$conf.low, tidy(hte1_b, conf.int = TRUE)$conf.low,
            tidy(hte2_a, conf.int = TRUE)$conf.low, tidy(hte2_b, conf.int = TRUE)$conf.low),
  
  upper = c(tidy(hte1_a, conf.int = TRUE)$conf.high, tidy(hte1_b, conf.int = TRUE)$conf.high,
            tidy(hte2_a, conf.int = TRUE)$conf.high, tidy(hte2_b, conf.int = TRUE)$conf.high)
)

```


# plot hte

```{r}
scaleFUN <- function(x) sprintf("%.4f", x)

plt_hte <-
  ggplot(aes(x = coef, y = group), data = out) +
  geom_point(size = 2) +
  geom_errorbarh(aes(xmin = lower, xmax = upper), 
                 size = 0.5, height = 0.2) +
  geom_vline(xintercept = 0, linetype = 2, color = "darkgrey") +
  facet_wrap(~ subgroup, scales = "free_y", nrow = 2) +
  geom_text(aes(x = 0.65, 
                label = paste0(N, " (p = ", scaleFUN(pvalue), ")")), size = 4, position = position_dodge(0.6)) +
  xlim(c(-1, 1)) +
  labs(x = "Estimated treatment effect on pro-democracy vote shares", y = " ") +
  theme_bw() +
  theme(
    axis.text = element_text(size = 12),
    strip.text = element_text(size = 12),
    axis.title.x = element_text(size = 12)) 
```



# correlation analysis: prop. of restaurants vs. # of protests in 2019----------

```{r}
##############
## Figure 9 ##
##############

# turn off s2
sf::sf_use_s2(FALSE)
# enable utf-8
showtext_auto()

# get the frequency of protests in a location in 2019
freq_protests <-
  cleaned_protests %>%
  group_by(location) %>%
  summarise(freq_protest = n()) %>%
  st_drop_geometry()

# spatial join and group by joined district
joined_protest_sites <-
  st_join(st_as_sf(cleaned_protests), st_as_sf(df_analysis)) %>%
  filter(year == 2019) %>%
  left_join(freq_protests, by = "location") %>%
  select(-event_id) %>%
  group_by(location) %>%
  slice(1) %>%
  group_by(fake_unit_id) %>%
  summarise(n_protests = sum(freq_protest, na.rm = T)) %>%
  st_drop_geometry()

# data frame
df_corr <-
  df_analysis %>%
  filter(year == 2019) %>%
  left_join(joined_protest_sites, by = "fake_unit_id") %>%
  select(fake_unit_id, n_protests, prop_Yellow, prop_votes_demo) 

# get correlations
# close to no correlation...
cor(df_corr$n_protests, df_corr$prop_Yellow, use = "complete.obs") # 0.06

cor(df_corr$n_protests, df_corr$prop_votes_demo, use = "complete.obs") # 0.002

# drop outlier
df_corr_no_outlier <-
  df_corr %>%
  filter(fake_unit_id != "ORIG57")

# also close to none
cor(df_corr_no_outlier$n_protests, df_corr_no_outlier$prop_Yellow, use = "complete.obs") #0.11
cor(df_corr_no_outlier$n_protests, df_corr_no_outlier$prop_votes_demo, use = "complete.obs") #-0.04

# plots
plt_cor_protests_prop_yellow <-
  df_corr %>%
  ggplot(aes(x = prop_Yellow, y = n_protests)) +
  geom_point(colour = "gold", size = 2, shape = 19) +
  geom_smooth(method = "lm", aes(color = "sienna1")) +
  ylim(c(0, 350)) +
  annotate("text", x = 0.85, y = 300,
           label = "r = 0.06",
           colour = "black", size = 5) +
  annotate("text", x = 0.3, y = 320,
           label = "Chung Wan (中環)",
           colour = "black", size = 4) +
  labs(y = "Number of protests", x = 'Prop. of "Yellow" restaurants') +
  theme_bw() +
    theme(
    axis.title.y = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    axis.title.x = element_text(size = 14),
    axis.text.x = element_text(size = 14),
    legend.position = "none"
  )

plt_cor_protests_votes_demo <-
  df_corr %>%
  ggplot(aes(y = n_protests, x = prop_votes_demo)) +
  geom_point(colour = "gold", size = 2, shape = 19) +
  geom_smooth(method = "lm", aes(color = "sienna1")) +
  ylim(c(0, 350)) +
  annotate("text", x = 0.85, y = 300,
           label = "r = 0.002",
           colour = "black", size = 5) +
  labs(y = " ", x = 'Vote shares: pro-democracy') +
  annotate("text", x = 0.5, y = 320,
           label = "Chung Wan (中環)",
           colour = "black", size = 4) +
  theme_bw() +
  theme(
    axis.title.y = element_text(size = 14),
    axis.text.y = element_text(size = 14),
    axis.title.x = element_text(size = 14),
    axis.text.x = element_text(size = 14),
    legend.position = "none"
  )

# put them together  
plt_cor_protests <-
  plot_grid(plt_cor_protests_prop_yellow, plt_cor_protests_votes_demo, labels = c('A', 'B'))

# save
pdf('plt_cor_protests.pdf', width = 9, height = 4.5)
plt_cor_protests
dev.off()
  
```







